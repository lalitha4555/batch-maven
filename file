pipeline
{
	agent any
    {
	stage('continuous download_loan') 
		{
			steps
			{
				script
				{
					try
					{
						git 'https://github.com/ArkLearnersEdge/maven.git'
					}
					catch(Exception e1)
					{
						mail bcc: '', body: 'download failure', cc: 'test@gmail.com', from: '', replyTo: '', subject: 'continuous download', to: 'developer@gmail.com'
						exit(1)
					}
				}
			}
		}
	    stage('continuous build_loan') 
		{
			steps
			{
				script
				{
					try
					{
						sh 'mvn package'
					}
					catch(Exception e2)
					{
						mail bcc: '', body: 'build failure', cc: 'test@gmail.com', from: '', replyTo: '', subject: 'continuous build', to: 'developer@gmail.com'
						exit(2)
					}
				}
			}
		}
		stage('continuous deploy_loan') 
		{
			steps
			{
				script
				{
					try
					{
						sh 'scp /home/ubuntu/.jenkins/workspace/multi-pipeline/webapp/target/webapp.war ubuntu@172.31.90.218:/var/lib/tomcat8/webapps/testapp'
					}
					catch(Exception e3)
					{
						mail bcc: '', body: 'deploy failure', cc: 'test@gmail.com', from: '', replyTo: '', subject: 'continuous deploy', to: 'developer@gmail.com'
						exit(3)
					}
				}
			}
		}
		stage('continuous testing_loan') 
		{
			steps
			{
				script
				{
					try
					{
						git 'https://github.com/ArkLearnersEdge/FunctionalTesting.git'
						 sh 'java -jar /home/ubuntu/.jenkins/workspace/multi-pipeline/testing.jar'
					}
					catch(Exception e4)
					{
						mail bcc: '', body: 'test failure', cc: 'developer@gmail.com', from: '', replyTo: '', subject: 'continuous testing', to: 'test@gmail.com'
						exit(4)
					}
				}
			}
		}
        stage('continuous production_loan') 
		{
			steps
			{
				script
				{
					try
					{
						sh 'scp /home/ubuntu/.jenkins/workspace/multi-pipeline/webapp/target/webapp.war ubuntu@172.31.88.220:/var/lib/tomcat8/webapps/prodapp'
					}
					catch(Exception e5)
					{
						mail bcc: '', body: 'production failure', cc: 'developer@gmail.com', from: '', replyTo: '', subject: 'continuous production', to: 'test@gmail.com'
						exit(5)
					}
				}
			}
		}
	}
}
